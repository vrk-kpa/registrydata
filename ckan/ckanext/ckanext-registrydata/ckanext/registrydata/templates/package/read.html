{% ckan_extends %}

{% import 'macros/layout.html' as layout %}

{% block content_header %}
<header class="page-header">
  <ul class="nav nav-tabs">
    <li class="active">{% link_for _('Dataset'), named_route=dataset_type ~ '.read', id=pkg.name %}</li>
    <li>{% link_for _('Categories'), named_route=dataset_type ~ '.groups', id=pkg.name %}</li>
    <li>{% link_for _('Activity'), named_route=dataset_type ~ '.activity', id=pkg.name %}</li>
</header>
{% endblock %}

{% block primary_content_inner %}
  <div class="row">
    <aside class="col-4 sidebar">
      {% block secondary_content %}
        {% block package_tags %}
          {{ layout.moduleBoxHeader(_('Keywords') ) }}
          {% snippet 'package/snippets/tags.html', tags=pkg.get('keywords', {}), field='keywords', pkg=pkg %}
          {{ layout.moduleBoxFooter() }}
        {% endblock %}

        {% block categories %}
          {{ layout.moduleBoxHeader(_('Categories') ) }}
          {% snippet 'package/snippets/categories.html', categories=pkg.get('groups', {}), pkg=pkg %}
          {{ layout.moduleBoxFooter() }}
        {% endblock %}

        {% block package_license %}{{ super() }}{% endblock %}

        {% block stats %}
          {% if 'get_visits_for_dataset' in h %}
          {{ layout.moduleBoxHeader(_('Stats') ) }}
          {% snippet 'package/snippets/package_matomo_stats.html', pkg=pkg %}
          {{ layout.moduleBoxFooter() }}
          {% endif %}
        {% endblock %}
      {% endblock %}
    </aside>

    <section class="col-8 main-content">
      {% block banner %}
        {% snippet 'package/snippets/dataset_state_banner.html', pkg=pkg %}
      {% endblock %}

      {% block package_description %}
        <h1>
          {% block page_heading %}{{ h.dataset_display_name(pkg) }}{% endblock %}
        </h1>
        {% block package_notes %}{{ super() }}{% endblock %}
      {% endblock %}

      {% block package_resources %}
        {% snippet "package/snippets/resources_list.html", pkg=pkg, resources=pkg.resources,
        can_edit=h.check_access('package_update', {'id':pkg.id }) %}
      {% endblock %}
      {% block package_additional_info %}
        {% snippet "package/snippets/additional_info.html", pkg_dict=pkg %}
      {% endblock %}
    </section>

  </div>
{% endblock %}
